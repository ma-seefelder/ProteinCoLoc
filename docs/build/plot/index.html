<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plot · ProteinCoLoc.jl</title><meta name="title" content="Plot · ProteinCoLoc.jl"/><meta property="og:title" content="Plot · ProteinCoLoc.jl"/><meta property="twitter:title" content="Plot · ProteinCoLoc.jl"/><meta name="description" content="Documentation for ProteinCoLoc.jl."/><meta property="og:description" content="Documentation for ProteinCoLoc.jl."/><meta property="twitter:description" content="Documentation for ProteinCoLoc.jl."/><meta property="og:url" content="https://ma-seefelder.github.io/ProteinCoLoc.jl/plot/"/><meta property="twitter:url" content="https://ma-seefelder.github.io/ProteinCoLoc.jl/plot/"/><link rel="canonical" href="https://ma-seefelder.github.io/ProteinCoLoc.jl/plot/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ProteinCoLoc.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProteinCoLoc.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../loading_image/">Load Images</a></li><li class="is-active"><a class="tocitem" href>Plot</a><ul class="internal"><li><a class="tocitem" href="#Plotting-functions"><span>Plotting functions</span></a></li><li><a class="tocitem" href="#Helper-functions"><span>Helper functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Plot</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plot</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ma-seefelder/ProteinCoLoc" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/master/docs/src/plot.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions-to-plot-results"><a class="docs-heading-anchor" href="#Functions-to-plot-results">Functions to plot results</a><a id="Functions-to-plot-results-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-to-plot-results" title="Permalink"></a></h1><ul><li><a href="#Functions-to-plot-results">Functions to plot results</a></li><li class="no-marker"><ul><li><a href="#Plotting-functions">Plotting functions</a></li><li><a href="#Helper-functions">Helper functions</a></li></ul></li></ul><h2 id="Plotting-functions"><a class="docs-heading-anchor" href="#Plotting-functions">Plotting functions</a><a id="Plotting-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-functions" title="Permalink"></a></h2><h3 id="Plot-correlation-of-each-image-patch"><a class="docs-heading-anchor" href="#Plot-correlation-of-each-image-patch">Plot correlation of each image patch</a><a id="Plot-correlation-of-each-image-patch-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-correlation-of-each-image-patch" title="Permalink"></a></h3><p>The plotting method plots the merged <code>MultiChannelimage</code> an displays the computed correlation metric for each image patch. The correlation mechanism are chosen based on the <code>cor_method</code>argument: </p><ul><li><code>:pearson</code>: Pearson correlation coefficient (PCC)</li><li><code>:spearman</code>: Spearman&#39;s rank correlation coefficient</li><li><code>:kendall</code>: Kendall rank correlation coefficient</li></ul><p>If <code>scale_channels</code> is set to true, the pixel intensities are scaled to a range between 0 and 1 using min-max scaling. </p><p><img src="../assets/patched_correlation.png" alt="Patched correlation plot"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.plot-Union{Tuple{T}, Tuple{MultiChannelImage, T}, Tuple{MultiChannelImage, T, Vector{T}}} where T&lt;:Int64" href="#ProteinCoLoc.plot-Union{Tuple{T}, Tuple{MultiChannelImage, T}, Tuple{MultiChannelImage, T, Vector{T}}} where T&lt;:Int64"><code>ProteinCoLoc.plot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot(
img::LoadImages.MultiChannelImage,
num_patches::T,
cor_channel::Vector{T} = [2, 3];
scale_channels::Bool = true,
file::String = &quot;test.png&quot;;
channel_for_plot::Vector{T} = [1, 2, 3],
save_to_file::Bool = true,
cor_method::Symbol = :pearson
) where {T &lt;: Int}

Plot the image with the patches and the correlation of each patch.

# Arguments
- `img::LoadImages.MultiChannelImage`: The image to plot.
- `num_patches::Int64`: The number of patches to use.
- `cor_channel::Vector{Int64}`: The channels to use for the calculation of correlation.
- `scale_channels::Bool`: Whether to scale the channels intensities to the range [0, 1].
- `file::String`: The file to save the plot to. Must end with .png or .svg.
- `channel_for_plot::Vector{Int64}`: The channels to use for plotting. Only 1-3 channels are supported.
    The first channel is plotted in blue, the second in green and the third in red.
- `save_to_file::Bool`: Whether to save the plot to the file.
- `cor_method::Symbol`: The method to use for the calculation of correlation. Default is :pearson. Other options are :spearman and :kendall.

# Example
```julia
path = [&quot;test_images/c1.tif&quot;, &quot;test_images/c2.tif&quot;, &quot;test_images/c3.tif&quot;]
img = LoadImages.MultiChannelImage(&quot;positive_sample&quot;, path, [&quot;blue&quot;, &quot;green&quot;, &quot;red&quot;])
mask = LoadImages._calculate_mask(img)
LoadImages._apply_mask!(img, mask)
cor_channel = [2, 3]
scale_channels = true
num_patches = 16

plot(img, num_patches, cor_channel, scale_channels, &quot;test.png&quot;)
```</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L81-L118">source</a></section></article><h3 id="Plot-mask"><a class="docs-heading-anchor" href="#Plot-mask">Plot mask</a><a id="Plot-mask-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-mask" title="Permalink"></a></h3><p>As explained in our <a href="https://doi.org/10.1038/s41598-024-63884-1">paper</a>, we use Otsu thresholding to compute a mask. This mask can be visualised using the function <code>plot_mask(img::MultiChannelImage, file::String)</code>. In these images all masked pixels are depicted black and non-masked pixels that are included in the analysis are white.</p><p><img src="../assets/mask.png" alt="Mask plot"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.plot_mask" href="#ProteinCoLoc.plot_mask"><code>ProteinCoLoc.plot_mask</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_mask(img::LoadImages.MultiChannelImage,file::String = &quot;test.png&quot;)
Plot the mask of the image with the channels separated by lines.
Save the plot to the file and also return it.

# Arguments
- `img::LoadImages.MultiChannelImage`: The image to plot.
- `file::String`: The file to save the plot to. Must end with .png or .svg.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L207-L215">source</a></section></article><h3 id="Plot-local-correlation-plot"><a class="docs-heading-anchor" href="#Plot-local-correlation-plot">Plot local correlation plot</a><a id="Plot-local-correlation-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-local-correlation-plot" title="Permalink"></a></h3><p>The local correlation plot allows for the visualisation of local colocalization patterns at a finer spatial scale and enables visualising variations in colocalization intensity within small image patches (ideally between 10 and 100 px). Robust estimates for individual patches are ensured by performing a correlation between intensities only if 15 or more pixels in a patch have intensities above Otsu’s threshold for both channels. If the chosen number of patches is too high, the number of patches is dynamically adjusted until at least 15 pixels in a patch have non-masked intensities. </p><p><img src="../assets/local_correlation.png" alt="Local correlation plot"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.local_correlation_plot" href="#ProteinCoLoc.local_correlation_plot"><code>ProteinCoLoc.local_correlation_plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">local_correlation_plot(
img::MultiChannelImage,
num_patches::Int,
cor_channel::Vector{Int} = [2, 3];
channel_for_plot::Vector{Int} = [1, 2, 3],
save::Bool = true,
file::String = &quot;local_correlation.png&quot;,
cor_method::Symbol = :pearson
)</code></pre><p>This function generates a local correlation plot for a multi-channel image.</p><p><strong>Arguments</strong></p><ul><li><code>img</code>: A MultiChannelImage representing the image.</li><li><code>num_patches</code>: An integer representing the number of patches to be analyzed.</li><li><code>cor_channel</code>: A Vector of two integers representing the channels for which the correlation is to be calculated. Default is [2, 3].</li><li><code>channel_for_plot</code>: A Vector of integers representing the channels to be plotted. Default is [1, 2, 3].</li><li><code>save</code>: A boolean indicating whether to save the plot to a file. Default is true.</li><li><code>file</code>: A string representing the filename for the output file. Default is &quot;local_correlation.png&quot;.</li><li><code>cor_method</code>: A Symbol representing the method to be used for the calculation of correlation. Default is :pearson. Other options are :spearman and :kendall.</li></ul><p><strong>Returns</strong></p><ul><li><code>fig</code>: A Figure object representing the generated plot.</li></ul><p><strong>Errors</strong></p><ul><li>Throws a warning if no patches with a successful correlation calculation exist.</li><li>Throws a warning if no local correlation plot could be generated.</li></ul><p><strong>Notes</strong></p><p>This function calculates the local correlation for each patch, checks that patches with a successful correlation calculation exist, tries a different patch size if necessary, plots the local correlation, and saves the plot to a file if specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L316-L347">source</a></section></article><h2 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.minmax_norm!-Tuple{Matrix{Float64}}" href="#ProteinCoLoc.minmax_norm!-Tuple{Matrix{Float64}}"><code>ProteinCoLoc.minmax_norm!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">minmax_norm!(img::Matrix{Float64})</code></pre><p>This function normalizes a 2D image matrix to the range [0, 1].</p><p><strong>Arguments</strong></p><ul><li><code>img</code>: A 2D matrix of Float64 representing the image to be normalized.</li></ul><p><strong>Returns</strong></p><ul><li><code>img</code>: The input image matrix, modified in-place, where each pixel value has been normalized to the range [0, 1].</li></ul><p><strong>Notes</strong></p><p>This function normalizes the image by subtracting the minimum pixel value from each pixel, and then dividing each pixel by the range of pixel values (maximum - minimum). The normalization is performed in-place, modifying the input image matrix directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L21-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.cm_to_px" href="#ProteinCoLoc.cm_to_px"><code>ProteinCoLoc.cm_to_px</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cm_to_px(cm::Float64, dpi::Int)::Int</code></pre><p>This function converts a measurement from centimeters to pixels, given a specific dots per inch (dpi) value.</p><p><strong>Arguments</strong></p><ul><li><code>cm</code>: A Float64 representing the measurement in centimeters.</li><li><code>dpi</code>: An integer representing the dots per inch (dpi) value.</li></ul><p><strong>Returns</strong></p><ul><li><code>px</code>: An integer representing the measurement in pixels.</li></ul><p><strong>Notes</strong></p><p>This function first converts the measurement from centimeters to inches, then converts the measurement from inches to pixels using the dpi value. The result is rounded to the nearest integer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L38-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ProteinCoLoc.calculate_font_size" href="#ProteinCoLoc.calculate_font_size"><code>ProteinCoLoc.calculate_font_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_font_size(
resolution::Tuple{Int, Int}, 
scale_factor::Float64
)</code></pre><p>This function calculates the font size based on the resolution of the plot and a scale factor.</p><p><strong>Arguments</strong></p><ul><li><code>resolution</code>: A tuple of two integers representing the width and height of the plot in pixels.</li><li><code>scale_factor</code>: A Float64 representing the scale factor to be applied to the resolution to calculate the font size.</li></ul><p><strong>Returns</strong></p><ul><li><code>font_size</code>: An integer representing the calculated font size.</li></ul><p><strong>Notes</strong></p><p>This function calculates the font size by taking the minimum of the width and height of the plot, multiplying it by the scale factor, and rounding the result to the nearest integer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ma-seefelder/ProteinCoLoc/blob/04971d7556ee7e840d8681a0a1c612799f77733e/src/plot.jl#L59-L76">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../loading_image/">« Load Images</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 1 August 2024 18:47">Thursday 1 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
